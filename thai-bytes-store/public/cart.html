<main class="p-6">
Â  <div id="cartItems"></div>
Â  <button onclick="placeOrder()" class="mt-4 bg-green-600 text-white px-6 py-2 rounded-full">ðŸ§¾ Place Order</button>
</main>
<script>
firebase.auth().onAuthStateChanged((user) => {
Â  if (!user) {
Â  Â  alert("Please login to view cart");
Â  Â  window.location.href = "login.html";
Â  Â  return;
Â  }

Â  const cartDiv = document.getElementById("cartItems");
Â  firebase.firestore().collection("cart")
Â  Â  .where("uid", "==", user.uid)
Â  Â  .orderBy("createdAt", "desc")
Â  Â  .get()
Â  Â  .then((snapshot) => {
Â  Â  Â  snapshot.forEach((doc) => {
Â  Â  Â  Â  const data = doc.data();
Â  Â  Â  Â  cartDiv.innerHTML += `
Â  Â  Â  Â  Â  <div class="bg-white p-4 shadow mb-4 rounded">
Â  Â  Â  Â  Â  Â  <h2 class="text-xl font-bold">${data.product}</h2>
Â  Â  Â  Â  Â  Â  <p>â‚¹${data.price} x ${data.quantity}</p>
Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  });
Â  Â  });
});

// Place Order Function
function placeOrder() {
Â  const user = firebase.auth().currentUser;
Â  if (!user) return;

Â  firebase.firestore().collection("cart")
Â  Â  .where("uid", "==", user.uid)
Â  Â  .get()
Â  Â  .then((snapshot) => {
Â  Â  Â  const batch = firebase.firestore().batch();
Â  Â  Â  snapshot.forEach((doc) => {
Â  Â  Â  Â  const data = doc.data();
Â  Â  Â  Â  const orderRef = firebase.firestore().collection("orders").doc();
Â  Â  Â  Â  batch.set(orderRef, {
Â  Â  Â  Â  Â  ...data,
Â  Â  Â  Â  Â  orderTime: firebase.firestore.FieldValue.serverTimestamp()
Â  Â  Â  Â  });
Â  Â  Â  Â  batch.delete(doc.ref);
Â  Â  Â  });
Â  Â  Â  return batch.commit();
Â  Â  })
Â  Â  .then(() => {
Â  Â  Â  alert("âœ… Order placed successfully!");
Â  Â  Â  location.reload();
Â  Â  });
}
</script>
